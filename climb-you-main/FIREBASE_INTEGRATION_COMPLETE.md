# ğŸ”¥ Firebase ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–çµ±åˆå®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

## ğŸ“‹ å®Ÿè£…æ¦‚è¦

ClimbYouã‚¢ãƒ—ãƒªã«Firebase Firestoreã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Œå…¨å®Ÿè£…ã—ã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿ãŒç¢ºå®Ÿã«ä¿å­˜ã•ã‚Œã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã‚‚å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

## âœ… å®Œäº†ã—ãŸæ©Ÿèƒ½

### ğŸ—ï¸ 1. Firebaseè¨­å®šã¨ã‚µãƒ¼ãƒ“ã‚¹å±¤

**ãƒ•ã‚¡ã‚¤ãƒ«:** `src/config/firebaseConfig.ts`
- âœ… Firebase Appã€Firestoreã€Authã€Functions ã®åˆæœŸåŒ–
- âœ… é–‹ç™º/æœ¬ç•ªç’°å¢ƒã®è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
- âœ… ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œï¼ˆFirebaseç„¡ã—ã§ã‚‚å‹•ä½œï¼‰
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½

**ãƒ•ã‚¡ã‚¤ãƒ«:** `src/services/firebase/firestoreTaskService.ts`
- âœ… ã‚¿ã‚¹ã‚¯CRUDæ“ä½œã®å®Œå…¨å®Ÿè£…
- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ç›£è¦–ï¼ˆonSnapshotï¼‰
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- âœ… ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰

### ğŸ“± 2. UIå±¤ã®çµ±åˆ

**ãƒ•ã‚¡ã‚¤ãƒ«:** `src/contexts/TaskContext.tsx`
- âœ… AsyncStorage ã‹ã‚‰ Firebase ã¸ã®å®Œå…¨ç§»è¡Œ
- âœ… éåŒæœŸæ“ä½œã®é©åˆ‡ãªå‡¦ç†
- âœ… ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã¨ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®ç®¡ç†
- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã®è‡ªå‹•åæ˜ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** `src/screens/TasksScreen.tsx`  
- âœ… éåŒæœŸã‚¿ã‚¹ã‚¯æ“ä½œã®å®Ÿè£…
- âœ… ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã®è¡¨ç¤º
- âœ… ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é©åˆ‡ãªè¡¨ç¤º
- âœ… UIæ“ä½œä¸­ã®é‡è¤‡å®Ÿè¡Œé˜²æ­¢

### ğŸ”§ 3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–

**ãƒ•ã‚¡ã‚¤ãƒ«:** `App.tsx`
- âœ… Firebase ã‚µãƒ¼ãƒ“ã‚¹ã®è‡ªå‹•åˆæœŸåŒ–
- âœ… ç’°å¢ƒè¨­å®šã®å‹•çš„èª­ã¿è¾¼ã¿
- âœ… ã‚¨ãƒ©ãƒ¼æ™‚ã®ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ãƒ»ãƒ‡ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

## ğŸ¯ ä¸»è¦æ©Ÿèƒ½

### ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿ç®¡ç†
```typescript
// ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¿ã‚¹ã‚¯ç›£è¦–
const unsubscribe = await firestoreTaskService.subscribeToTasks((updatedTasks) => {
  setTasks(updatedTasks); // è‡ªå‹•æ›´æ–°
});

// CRUDæ“ä½œ
await firestoreTaskService.createTask(title, description);
await firestoreTaskService.updateTask(id, { completed: true });
await firestoreTaskService.deleteTask(id);
```

### ãƒ‡ãƒ¥ã‚¢ãƒ«ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- **æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰:** Firebase Firestoreä½¿ç”¨
- **ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰:** ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨
- è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ä»˜ã

### ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼
- åŒ¿åèªè¨¼ã«ã‚ˆã‚‹è‡ªå‹•ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥
- ãƒ‡ãƒã‚¤ã‚¹å›ºæœ‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDç”Ÿæˆ
- ãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨åˆ†é›¢

## ğŸ“Š æŠ€è¡“ä»•æ§˜

### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
```typescript
interface FirestoreTask {
  id: string;
  title: string;
  description: string;
  completed: boolean;
  createdAt: Timestamp | Date;
  completedAt?: Timestamp | Date;
  userId: string;
  isDummy?: boolean;
}
```

### Firestoreã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ§‹é€ 
```
tasks/
â”œâ”€â”€ {taskId1}
â”‚   â”œâ”€â”€ title: string
â”‚   â”œâ”€â”€ description: string
â”‚   â”œâ”€â”€ completed: boolean
â”‚   â”œâ”€â”€ createdAt: Timestamp
â”‚   â”œâ”€â”€ completedAt?: Timestamp
â”‚   â””â”€â”€ userId: string
â””â”€â”€ {taskId2}
    â””â”€â”€ ...
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ï¼ˆæ¨å¥¨ï¼‰
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /tasks/{taskId} {
      allow read, write: if request.auth != null 
        && resource.data.userId == request.auth.uid;
    }
  }
}
```

## ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 1. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°æœ€é©åŒ–
- onSnapshot ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªç›£è¦–
- ä¸è¦ãªãƒªã‚¹ãƒŠãƒ¼ã®è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢

### 2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- 3å±¤ã‚¨ãƒ©ãƒ¼å¯¾å¿œï¼ˆFirebase â†’ ãƒ­ãƒ¼ã‚«ãƒ« â†’ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- æ¥ç¶šå¤±æ•—æ™‚ã®è‡ªå‹•å¾©æ—§

### 3. ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹
- æ“ä½œä¸­ã®UIç„¡åŠ¹åŒ–
- è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- é‡è¤‡æ“ä½œé˜²æ­¢

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

### æ‰‹å‹•ãƒ†ã‚¹ãƒˆ
1. **ã‚¢ãƒ—ãƒªèµ·å‹•:** FirebaseåˆæœŸåŒ–ãƒ­ã‚°ã‚’ç¢ºèª
2. **ã‚¿ã‚¹ã‚¯ä½œæˆ:** æ–°ã—ã„ã‚¿ã‚¹ã‚¯ãŒå³åº§ã«è¡¨ç¤ºã•ã‚Œã‚‹
3. **ã‚¿ã‚¹ã‚¯æ›´æ–°:** å®Œäº†çŠ¶æ…‹ã®åˆ‡ã‚Šæ›¿ãˆãŒåæ˜ ã•ã‚Œã‚‹
4. **ã‚¿ã‚¹ã‚¯å‰Šé™¤:** ã‚¿ã‚¹ã‚¯ãŒç”»é¢ã‹ã‚‰æ¶ˆãˆã‚‹
5. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ:** è¤‡æ•°ãƒ‡ãƒã‚¤ã‚¹é–“ã§ã®åŒæœŸç¢ºèª

### è‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆä½œæˆæ¸ˆã¿ï¼‰
```bash
node test_firebase_integration.js
```

## ğŸ“ˆ ç›£è¦–ã¨ãƒ‡ãƒãƒƒã‚°

### ãƒ­ã‚°å‡ºåŠ›
```
ğŸ”„ Environment config reset
ğŸ”¥ Firebase services initialized successfully
ğŸ’¾ Hybrid storage initialized successfully
ğŸš€ All services initialized successfully
ğŸ“¡ Real-time task update: 3
ğŸ”¥ Task created in Firestore: abc123
```

### ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
ç’°å¢ƒå¤‰æ•° `EXPO_PUBLIC_DEBUG_API_CALLS=true` ã§è©³ç´°ãƒ­ã‚°æœ‰åŠ¹

## ğŸ”® æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### Phase 2: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
- [ ] Profileç”»é¢ã®å®Ÿè£…
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–
- [ ] ã‚¢ãƒã‚¿ãƒ¼ã¨çµ±è¨ˆãƒ‡ãƒ¼ã‚¿

### Phase 3: ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çµ±åˆ  
- [ ] ç›®æ¨™è¨­å®šãƒ‡ãƒ¼ã‚¿ã®Firebaseä¿å­˜
- [ ] ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è³ªå•å›ç­”ã®æ°¸ç¶šåŒ–
- [ ] ã‚¯ã‚¨ã‚¹ãƒˆè¨­å®šã®ä¿å­˜

### Phase 4: é«˜åº¦ãªæ©Ÿèƒ½
- [ ] ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œã®æ”¹å–„
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©å…ƒæ©Ÿèƒ½
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ

## ğŸ‰ æˆæœã‚µãƒãƒªãƒ¼

**å®Ÿè£…å®Œäº†åº¦: 90%**

âœ… **å®Œäº†é …ç›®**
- Firebase Firestoreå®Œå…¨çµ±åˆ
- ã‚¿ã‚¹ã‚¯CRUDæ“ä½œ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹
- ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ

ğŸ”„ **é€²è¡Œä¸­é …ç›®**  
- Profileç”»é¢å®Ÿè£…
- è¿½åŠ ãƒ‡ãƒ¼ã‚¿å‹ã®æ°¸ç¶šåŒ–

ğŸ“‹ **ä»Šå¾Œã®å±•é–‹**
- AIæ©Ÿèƒ½ã¨ã®ãƒ‡ãƒ¼ã‚¿é€£æº
- é«˜åº¦ãªåŒæœŸæ©Ÿèƒ½
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

---

**Firebaseçµ±åˆã«ã‚ˆã‚Šã€ClimbYouã¯å …ç‰¢ã§æ‹¡å¼µæ€§ã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã‚·ã‚¹ãƒ†ãƒ ã‚’ç²å¾—ã—ã¾ã—ãŸï¼** ğŸš€